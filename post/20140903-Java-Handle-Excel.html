<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Java操作Excel · 有所思</title><meta name="description" content="Java操作Excel - Yunxu"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/img/20170901194821_qHtiKc_logo_transparent.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="https://github.com/yunxu-it/yunxu-it.github.io/atom.xml" title="有所思"><meta name="generator" content="Hexo 5.0.2"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/img/logo_blue_round.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://www.yuque.com/moreve/nycnfq" target="_blank" class="nav-list-link">XUER</a></li><li class="nav-list-item"><a href="https://github.com/yunxu-it" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/about" target="_self" class="nav-list-link">ABOUT</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">Java操作Excel</h1><div class="post-info">2014年09月03日<a href="http://www.cnblogs.com/sunzhenxing19860608/archive/2010/12/27/1918128.html" target="_blank" title="http://www.cnblogs.com/sunzhenxing19860608/archive/2010/12/27/1918128.html" class="post-from">转载 · 原文地址</a></div><div class="post-content"><p>jxl是一个韩国人写的java操作excel的工具, 在开源世界中，有两套比较有影响的API可供使用，一个是POI，一个是jExcelAPI。其中功能相对POI比较弱一点。但jExcelAPI对中文支持非常好，API是纯Java的， 并不依赖Windows系统，即使运行在Linux下，它同样能够正确的处理Excel文件。 另外需要说明的是，这套API对图形和图表的支持很有限，而且仅仅识别PNG格式。</p>
<hr>
<h3 id="1-搭建环境"><a href="#1-搭建环境" class="headerlink" title="1. 搭建环境"></a><a href="#Build">1. 搭建环境</a></h3><h3 id="2-基本操作"><a href="#2-基本操作" class="headerlink" title="2. 基本操作"></a><a href="#Base">2. 基本操作</a></h3><ul>
<li><a href="#Creat">创建文件</a></li>
<li><a href="#Read">读取文件</a></li>
<li><a href="#Modify">修改文件</a></li>
</ul>
<h3 id="3-其他操作"><a href="#3-其他操作" class="headerlink" title="3. 其他操作"></a><a href="#Other">3. 其他操作</a></h3><ul>
<li><a href="#Data">数据化操作</a></li>
<li><a href="#Unit">单元格操作</a></li>
</ul>
<hr>
<a id="more"></a>

<h3 id="搭建环境"><a href="#搭建环境" class="headerlink" title="搭建环境"></a><a name="Build">搭建环境</a></h3><hr>
<p>将<a target="_blank" rel="noopener" href="http://www.andykhan.com/jexcelapi/download.html">下载</a>后的文件解包，得到jxl.jar，放入classpath，安装就完成了。（其实我是把它放到lib文件夹下） </p>
<h3 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a><a name="Base">基本操作</a></h3><hr>
<h4 id="一、创建文件"><a href="#一、创建文件" class="headerlink" title="一、创建文件"></a><a name="Creat">一、创建文件</a></h4><ul>
<li>拟生成一个名为“test.xls”的Excel文件，其中第一个工作表被命名为“第一页”，大致效果如下：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> test;</span><br><span class="line"></span><br><span class="line"><span class="comment">//生成Excel的类</span></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> jxl.Workbook;</span><br><span class="line"><span class="keyword">import</span> jxl.write.Label;</span><br><span class="line"><span class="keyword">import</span> jxl.write.WritableSheet;</span><br><span class="line"><span class="keyword">import</span> jxl.write.WritableWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CreateExcel</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 打开文件</span></span><br><span class="line">            WritableWorkbook book = Workbook.createWorkbook(<span class="keyword">new</span> File(<span class="string">&quot;test.xls&quot;</span>));</span><br><span class="line">            <span class="comment">// 生成名为“第一页”的工作表，参数0表示这是第一页</span></span><br><span class="line">            WritableSheet sheet = book.createSheet(<span class="string">&quot;第一页&quot;</span>, <span class="number">0</span>);</span><br><span class="line">            <span class="comment">// 在Label对象的构造子中指名单元格位置是第一列第一行(0,0)</span></span><br><span class="line">            <span class="comment">// 以及单元格内容为test</span></span><br><span class="line">            Label label = <span class="keyword">new</span> Label(<span class="number">0</span>, <span class="number">0</span>, <span class="string">&quot;test&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 将定义好的单元格添加到工作表中</span></span><br><span class="line">             sheet.addCell(label);</span><br><span class="line"></span><br><span class="line">             <span class="comment">/*</span></span><br><span class="line"><span class="comment">              * 生成一个保存数字的单元格 必须使用Number的完整包路径，否则有语法歧义 单元格位置是第二列，第一行，值为789.123</span></span><br><span class="line"><span class="comment">              */</span></span><br><span class="line">            jxl.write.Number number = <span class="keyword">new</span> jxl.write.Number(<span class="number">1</span>, <span class="number">0</span>, <span class="number">555.12541</span>);</span><br><span class="line">            sheet.addCell(number);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 写入数据并关闭文件</span></span><br><span class="line">            book.write();</span><br><span class="line">            book.close();</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                System.out.println(e);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
编译执行后，会产生一个Excel文件<h4 id="二、读取文件"><a href="#二、读取文件" class="headerlink" title="二、读取文件"></a><a name="Read">二、读取文件</a></h4></li>
</ul>
<ul>
<li>以刚才我们创建的Excel文件为例，做一个简单的读取操作，程序代码如下：<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> test;</span><br><span class="line"></span><br><span class="line"><span class="comment">//读取Excel的类</span></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> jxl.Cell;</span><br><span class="line"><span class="keyword">import</span> jxl.Sheet;</span><br><span class="line"><span class="keyword">import</span> jxl.Workbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ReadExcel</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span> </span>&#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Workbook book = Workbook.getWorkbook(<span class="keyword">new</span> File(<span class="string">&quot;test.xls&quot;</span>));</span><br><span class="line">                <span class="comment">// 获得第一个工作表对象</span></span><br><span class="line">                Sheet sheet = book.getSheet(<span class="number">0</span>);</span><br><span class="line">                <span class="comment">// 得到第一列第一行的单元格</span></span><br><span class="line">                Cell cell1 = sheet.getCell(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">                String result = cell1.getContents();</span><br><span class="line">                System.out.println(result);</span><br><span class="line">                book.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                System.out.println(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">程序执行结果：test</span><br></pre></td></tr></table></figure>
<h4 id="三、修改文件"><a href="#三、修改文件" class="headerlink" title="三、修改文件"></a><a name="Modify">三、修改文件</a></h4></li>
</ul>
<ul>
<li>利用jExcelAPI可以修改已有的Excel文件，修改Excel文件的时候，除了打开文件的方式不同之外，其他操作和创建Excel是一样的。下面的例子是在我们已经生成的Excel文件中添加一个工作表：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.File;</span><br><span class="line"><span class="keyword">import</span> jxl.Workbook;</span><br><span class="line"><span class="keyword">import</span> jxl.write.Label;</span><br><span class="line"><span class="keyword">import</span> jxl.write.WritableSheet;</span><br><span class="line"><span class="keyword">import</span> jxl.write.WritableWorkbook;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UpdateExcel</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String args[])</span> </span>&#123;</span><br><span class="line">         <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// Excel获得文件</span></span><br><span class="line">            Workbook wb = Workbook.getWorkbook(<span class="keyword">new</span> File(<span class="string">&quot;test.xls&quot;</span>));</span><br><span class="line">            <span class="comment">// 打开一个文件的副本，并且指定数据写回到原文件</span></span><br><span class="line">            WritableWorkbook book = Workbook.createWorkbook(<span class="keyword">new</span> File(<span class="string">&quot;test.xls&quot;</span>),wb);</span><br><span class="line">            <span class="comment">// 添加一个工作表</span></span><br><span class="line">            WritableSheet sheet = book.createSheet(<span class="string">&quot;第二页&quot;</span>, <span class="number">1</span>);</span><br><span class="line">            sheet.addCell(<span class="keyword">new</span> Label(<span class="number">0</span>, <span class="number">0</span>, <span class="string">&quot;第二页的测试数据&quot;</span>));</span><br><span class="line">            book.write();</span><br><span class="line">            book.close();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            System.out.println(e);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="其他操作"><a href="#其他操作" class="headerlink" title="其他操作"></a><a name="Other">其他操作</a></h3><hr>
<h4 id="数据格式化"><a href="#数据格式化" class="headerlink" title="数据格式化"></a><a name="Data">数据格式化</a></h4><p>在Excel中不涉及复杂的数据类型，能够比较好的处理字串、数字和日期已经能够满足一般的应用。</p>
<ol>
<li>字串格式化</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">字符串的格式化涉及到的是字体、粗细、字号等元素，这些功能主要由WritableFont和WritableCellFormat类来负责。</span><br><span class="line">假设我们在生成一个含有字串的单元格时，使用如下语句，为方便叙述，我们为每一行命令加了编号：</span><br><span class="line"></span><br><span class="line">WritableFont font1=</span><br><span class="line"><span class="keyword">new</span> WritableFont(WritableFont.TIMES,<span class="number">16</span>,WritableFont.BOLD); ①</span><br><span class="line">WritableCellFormat format1=<span class="keyword">new</span> WritableCellFormat(font1); ②</span><br><span class="line">Label label=<span class="keyword">new</span> Label(<span class="number">0</span>,<span class="number">0</span>,”data <span class="number">4</span> test”,format1) ③</span><br><span class="line"></span><br><span class="line">其中</span><br><span class="line">①指定了字串格式：字体为TIMES，字号<span class="number">16</span>，加粗显示。WritableFont有非常丰富的构造子，供不同情况下使用，jExcelAPI的java-doc中有详细列表，这里不再列出。</span><br><span class="line">②处代码使用了WritableCellFormat类，这个类非常重要，通过它可以指定单元格的各种属性，后面的单元格格式化中会有更多描述。</span><br><span class="line">③处使用了Label类的构造子，指定了字串被赋予那种格式。 </span><br><span class="line"></span><br><span class="line">在WritableCellFormat类中，还有一个很重要的方法是指定数据的对齐方式，比如针对我们上面的实例，可以指定：</span><br><span class="line">    </span><br><span class="line"><span class="comment">//把水平对齐方式指定为居中</span></span><br><span class="line">format1.setAlignment(jxl.format.Alignment.CENTRE);</span><br><span class="line">    </span><br><span class="line"><span class="comment">//把垂直对齐方式指定为居中</span></span><br><span class="line">format1.setVerticalAlignment(jxl.format.VerticalAlignment.CENTRE);</span><br></pre></td></tr></table></figure>

<h4 id="单元格操作"><a href="#单元格操作" class="headerlink" title="单元格操作"></a><a name="Unit">单元格操作</a></h4><p>Excel中很重要的一部分是对单元格的操作，比如行高、列宽、单元格合并等，所幸jExcelAPI提供了这些支持。这些操作相对比较简单，下面只介绍一下相关的API。 </p>
<ol>
<li>合并单元格<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">WritableSheet.mergeCells(<span class="keyword">int</span> m,<span class="keyword">int</span> n,<span class="keyword">int</span> p,<span class="keyword">int</span> q); </span><br><span class="line"></span><br><span class="line"><span class="comment">//作用是从(m,n)到(p,q)的单元格全部合并，比如：</span></span><br><span class="line">WritableSheet sheet=book.createSheet(“第一页”,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//合并第一列第一行到第六列第一行的所有单元格</span></span><br><span class="line">sheet.mergeCells(<span class="number">0</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">合并既可以是横向的，也可以是纵向的。合并后的单元格不能再次进行合并，否则会触发异常。</span><br></pre></td></tr></table></figure></li>
<li>行高和列宽<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">WritableSheet.setRowView(<span class="keyword">int</span> i,<span class="keyword">int</span> height);</span><br><span class="line"><span class="comment">//作用是指定第i+1行的高度，比如：</span></span><br><span class="line"></span><br><span class="line">sheet.setRowView(<span class="number">0</span>,<span class="number">200</span>);</span><br><span class="line"><span class="comment">//将第一行的高度设为200</span></span><br><span class="line"></span><br><span class="line">WritableSheet.setColumnView(<span class="keyword">int</span> i,<span class="keyword">int</span> width);</span><br><span class="line"><span class="comment">//作用是指定第i+1列的宽度，比如：</span></span><br><span class="line"></span><br><span class="line">sheet.setColumnView(<span class="number">0</span>,<span class="number">30</span>);</span><br><span class="line"><span class="comment">//将第一列的宽度设为30</span></span><br></pre></td></tr></table></figure>
jExcelAPI还有其他的一些功能，比如插入图片等，这里就不再一一介绍，读者可以自己探索。</li>
</ol>
<ul>
<li>其中：如果读一个excel，需要知道它有多少行和多少列，如下操作： <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Workbook book = Workbook.getWorkbook(<span class="keyword">new</span> File(<span class="string">&quot;测试1.xls&quot;</span>));</span><br><span class="line"><span class="comment">// 获得第一个工作表对象</span></span><br><span class="line">Sheet sheet = book.getSheet(<span class="number">0</span>);</span><br><span class="line"><span class="comment">// 得到第一列第一行的单元格</span></span><br><span class="line"><span class="keyword">int</span> columnum = sheet.getColumns();<span class="comment">// 得到列数</span></span><br><span class="line"><span class="keyword">int</span> rownum = sheet.getRows();<span class="comment">// 得到行数</span></span><br><span class="line">System.out.println(columnum);</span><br><span class="line">System.out.println(rownum);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; rownum; i++)<span class="comment">// 循环进行读写</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; columnum; j++) &#123;</span><br><span class="line">        Cell cell1 = sheet.getCell(j, i);</span><br><span class="line">        String result = cell1.getContents();</span><br><span class="line">        System.out.print(result);</span><br><span class="line">        System.out.print(<span class="string">&quot;\t&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    System.out.println();</span><br><span class="line">&#125;</span><br><span class="line">book.close();</span><br></pre></td></tr></table></figure>
转自<a target="_blank" rel="noopener" href="http://www.cnblogs.com/sunzhenxing19860608/archive/2010/12/27/1918128.html">http://www.cnblogs.com/sunzhenxing19860608/archive/2010/12/27/1918128.html</a></li>
</ul>
</div></article></div></main><footer><div class="paginator"><a href="/post/20140906-Bit-Operation.html" class="prev">PREV</a><a href="/post/20140903-Linux-Mint-LAMP.html" class="next">NEXT</a></div><!--include partial/comment--><div class="copyright"><p>本站点采用<a href="https://creativecommons.org/licenses/by-nc-nd/4.0/deed.zh" target="_blank"><u>知识共享 署名-非商业性使用-禁止演绎 4.0 国际许可协议</u></a></p><p>本站点基于<a href="https://hexo.io/" target="_blank">Hexo</a>，采用主题<a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>。<span id=busuanzi_container_site_uv>本站总访问量<span id=busuanzi_value_site_uv></span> 次</span> - © 2014 - 2023</p></div><!--#[a(href=config.url)!= config.author],--></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></body></html>